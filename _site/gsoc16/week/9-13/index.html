<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>    <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>    <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
  <head>
    <meta charset="utf-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>GSOC2016: Weeks 9-13</title>
    <meta name="description" content="GSOC2016: Weeks 9-13">
    <meta property="og:locale" content="en_US"><meta property="og:type" content="article"><meta property="og:title" content="Weeks 9-13: Interactive training, new user interface, tutorial notebooks, documentation - Google Summer of Code Blog"><meta property="og:site_name" content="Google Summer of Code Blog"><meta property="og:description" content="GSOC2016: Weeks 9-13"><meta property="og:url" content="/gsoc16/week/9-13/"><meta property="article:published_time" content="2016-08-14T00:00:00+02:00"><meta property="article:author" content="/about">

    

    
    <meta name="google-site-verification" content="UA-78841281-1" />
    

    <link rel="alternate" type="application/rss+xml" href="/feed.xml">
    <link rel="shortcut icon" href="/favicon.ico">
    <link rel="prefetch" href="">
    <link rel="canonical" href="/gsoc16/week/9-13/">
    <link rel="stylesheet"
    href="/assets/css/main.css">

    <!-- IE Fixes -->
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <style type="text/css">a,.post-title a{color:#205081}a:hover{border-bottom-color:#205081}.sidebar{background-color:#205081}.wc-top,.sidebar-toggle:active,#sidebar-checkbox:checked ~ .sidebar-toggle{background-color:#205081}.sidebar a:hover,.sidebar .sidebar-nav a{border-bottom-color:#255d95}.sidebar .sidebar-nav{border-top-color:#255d95}.sidebar .sidebar-nav a.sidebar-nav-item:hover,.sidebar .sidebar-nav a.sidebar-nav-item:focus{background:#23588d}.sidebar .sidebar-nav .sidebar-nav-item.active{background-color:#1d4875}ul.social-media li>a{background-color:#1d4875;border-color:#255d95;border-bottom-color:#255d95 !important}ul.social-media li>a:hover{background-color:#b4d0ec}.btn{border-color:#205081;background:#205081}.btn:hover,.btn:focus{border-color:#1b436d;background:#1b436d}ul ol{padding-left:30px}ul ul{padding-left:30px}</style>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.js"></script>
    <script type="text/javascript">
function getContainer(){
  var scriptTag = document.getElementsByTagName('script');
  scriptTag = scriptTag[scriptTag.length - 1];
  return scriptTag.parentNode;
}
require.config({
  paths:{
    'blogJsMVA':'https://rawgit.com/qati/GSOC16/master/src/js/blogJsMVA.min'
  }
});
var jsmva_div_num = (function(){
  var num = 0;
  return function(action){
    if (action===undefined){
      return num;
    }
    num += 1;
    return;
  }
})();
</script>

  </head>
  <body>
    <input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox"><div class="sidebar" id="sidebar">    <img    src="/assets/images/avatar.jpg"    alt="Google Summer of Code Blog" />    <div class="sidebar-info">      <p>        This is my Blog for Google Summer of Code. I'm working on TMVA (machine learning framework, part of ROOT) and Jupyter integration layer at CERN SFT.      </p>  </div>  <nav class="sidebar-nav">    <a class="sidebar-nav-item"      href="/">      Home    </a>                <a class="sidebar-nav-item "      href="/about">      About me    </a>                <a class="sidebar-nav-item "      href="/archive">      Blog Archive    </a>        <a class="sidebar-nav-item"      href="http://github.com/qati"      target="_blank">      GitHub    </a>  </nav>  <div class="sidebar-info small">     <p>       Made by <a href="http://gayan.me" target="_blank">Gayan Virajith</a> For everyone.       Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a>     </p>  </div>  <ul class="social-media">        <li>        <a title="q_atti on Twitter"             href="https://twitter.com/q_atti"             class="twitter wc-img-replace" target="_blank">Twitter</a>    </li>                   <li>        <a title="battila93 on Facebook"             href="https://facebook.com/battila93"             class="facebook wc-img-replace" target="_blank">Facebook</a>    </li>            <li>        <a title="qati on Github"             href="https://github.com/qati"             class="github wc-img-replace" target="_blank">Github</a>    </li>                 <li>        <a title="Subscribe via RSS"             href="/feed.xml"            class="rss wc-img-replace" target="_blank">            RSS        </a>    </li></ul></div>

    <div class="main-wrapper">
      <div class="header">
        <div class="container">
          <div class="header-logo"><a href="/"   title="Google Summer of Code Blog">  <img     src="/assets/images/logo.png"    alt="Google Summer of Code Blog" /></a></div>
          <div class="header-title">
            <a href="/"
              title="Google Summer of Code Blog">
              <h3>Google Summer of Code Blog<small>CERN SFT</small></h3>
            </a>
          </div>
        </div>
      </div>

      <div class="container content">
          <div class="post">

  

  

  <header class="post-header">
    <h1 class="post-title">Weeks 9-13: Interactive training, new user interface, tutorial notebooks, documentation</h1>
    <p class="post-meta">
    
      <span class="categories">
      gsoc16
      </span> |
    
    <span class="post-date">
    Aug 14, 2016  
    </span>
    </p>
  </header>

  <article class="post-content">
    <p>This weeks included a lot of debugging, making a new pytonic interface for TMVA, making tutorial notebooks and writing documentation.</p>

<p>These weeks first I worked on interactive training mode, this needed a lot of debugging. First there was a problem related to pyroot and GIL, this was fixed by Enric. The bigger problem which took a lot of time was that the output streams in TMVA are atomic type, which caused a crash if in python the main thread was free. The reason of this was that jupyter use tornado, which IO loop will restart on main thread periodically and will flush the output. But the output stream is an atomic type, which is not consistent with this flushing. This caused a crash. To solve the problem, I made a loop in main thread, which refreshes the plot and keep the main thread busy so there won’t be conflict with atomic output stream.</p>

<p>Also made some wrapper function for TMVA basic functions (these functions are changed to the wrapper function when we activate jsmva). The new wrapper functions provide a new, user friendly interface, where instead of using long option string, we can pass the settings to functions by named variables.</p>

<p>List of changed functions:</p>

<ol>
  <li>
    <p>Factory constructor:</p>

    <ul>
      <li>Old version:</li>
    </ul>
  </li>
</ol>

<figure class="highlight"><pre><code class="language-python" data-lang="python">   <span class="n">factory</span> <span class="o">=</span> <span class="n">TMVA</span><span class="o">.</span><span class="n">Factory</span><span class="p">(</span> <span class="s">"TMVAClassification"</span><span class="p">,</span> <span class="n">outputFile</span> <span class="c">#this is optional</span>
                       <span class="p">,</span><span class="s">"!V:Color:DrawProgressBar:Transformations=I;D;P;G,D:AnalysisType=Classification"</span> <span class="p">)</span>
   </code></pre></figure>

<ul>
  <li>New version:</li>
</ul>

<figure class="highlight"><pre><code class="language-python" data-lang="python">   <span class="n">factory</span> <span class="o">=</span> <span class="n">TMVA</span><span class="o">.</span><span class="n">Factory</span><span class="p">(</span><span class="n">JobName</span><span class="o">=</span><span class="s">"TMVAClassification"</span><span class="p">,</span> <span class="n">TargetFile</span><span class="o">=</span><span class="n">outputFile</span><span class="p">,</span>
                        <span class="n">V</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">Color</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">DrawProgressBar</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">Transformations</span><span class="o">=</span><span class="p">[</span><span class="s">"I"</span><span class="p">,</span> <span class="s">"D"</span><span class="p">,</span> <span class="s">"P"</span><span class="p">,</span> <span class="s">"G"</span><span class="p">,</span> <span class="s">"D"</span><span class="p">],</span>
                        <span class="n">AnalysisType</span><span class="o">=</span><span class="s">"Classification"</span><span class="p">)</span>
   </code></pre></figure>

<ol>
  <li>DataLoader::PrepareTrainingAndTestTree: new version</li>
</ol>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">loader</span><span class="o">.</span><span class="n">PrepareTrainingAndTestTree</span><span class="p">(</span><span class="n">SigCut</span><span class="o">=</span><span class="n">mycuts</span><span class="p">,</span> <span class="n">BkgCut</span><span class="o">=</span><span class="n">mycutb</span><span class="p">,</span>
                    <span class="n">nTrain_Signal</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">nTrain_Background</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">SplitMode</span><span class="o">=</span><span class="s">"Random"</span><span class="p">,</span> <span class="n">NormMode</span><span class="o">=</span><span class="s">"NumEvents"</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></code></pre></figure>

<ol>
  <li>Factory::BookMethod: new version</li>
</ol>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">factory</span><span class="o">.</span><span class="n">BookMethod</span><span class="p">(</span> <span class="n">DataLoader</span><span class="o">=</span><span class="n">loader</span><span class="p">,</span> <span class="n">Method</span><span class="o">=</span><span class="n">TMVA</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">kMLP</span><span class="p">,</span> <span class="n">MethodTitle</span><span class="o">=</span><span class="s">"MLP"</span><span class="p">,</span> 
        <span class="n">H</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">V</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">NeuronType</span><span class="o">=</span><span class="s">"tanh"</span><span class="p">,</span> <span class="n">VarTransform</span><span class="o">=</span><span class="s">"N"</span><span class="p">,</span> <span class="n">NCycles</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span> <span class="n">HiddenLayers</span><span class="o">=</span><span class="s">"N+5"</span><span class="p">,</span>
                   <span class="n">TestRate</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">UseRegulator</span><span class="o">=</span><span class="bp">False</span> <span class="p">)</span></code></pre></figure>

<ol>
  <li>Factory::CrossValidation: new version</li>
</ol>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">factory</span><span class="o">.</span><span class="n">CrossValidate</span><span class="p">(</span><span class="n">DataLoader</span><span class="o">=</span><span class="n">loader</span><span class="p">,</span> <span class="n">Method</span><span class="o">=</span><span class="n">TMVA</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">kBDT</span><span class="p">,</span> <span class="n">MethodTitle</span><span class="o">=</span><span class="s">"BDT"</span><span class="p">,</span>
        <span class="n">V</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">NTrees</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">MinNodeSize</span><span class="o">=</span><span class="s">"2.5</span><span class="si">%</span><span class="s">"</span><span class="p">,</span> <span class="n">MaxDepth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">BoostType</span><span class="o">=</span><span class="s">"AdaBoost"</span><span class="p">,</span> <span class="n">AdaBoostBeta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">UseBaggedBoost</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span> <span class="n">BaggedSampleFraction</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">SeparationType</span><span class="o">=</span><span class="s">"GiniIndex"</span><span class="p">,</span> <span class="n">nCuts</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> 
            <span class="n">optParams</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span></code></pre></figure>

<ol>
  <li>Factory::EvaluateImportance: new version</li>
</ol>

<figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="n">factory</span><span class="o">.</span><span class="n">EvaluateImportance</span><span class="p">(</span><span class="n">DataLoader</span><span class="o">=</span><span class="n">loader</span><span class="p">,</span><span class="n">VIType</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">Method</span><span class="o">=</span><span class="n">TMVA</span><span class="o">.</span><span class="n">Types</span><span class="o">.</span><span class="n">kBDT</span><span class="p">,</span> <span class="n">MethodTitle</span><span class="o">=</span><span class="s">"BDT"</span><span class="p">,</span>
            <span class="n">V</span><span class="o">=</span><span class="bp">False</span><span class="p">,</span><span class="n">NTrees</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">MinNodeSize</span><span class="o">=</span><span class="s">"2.5</span><span class="si">%</span><span class="s">"</span><span class="p">,</span><span class="n">MaxDepth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">BoostType</span><span class="o">=</span><span class="s">"AdaBoost"</span><span class="p">,</span> <span class="n">AdaBoostBeta</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> 
            <span class="n">UseBaggedBoost</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span> <span class="n">BaggedSampleFraction</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">SeparationType</span><span class="o">=</span><span class="s">"GiniIndex"</span><span class="p">,</span> <span class="n">nCuts</span><span class="o">=</span><span class="mi">20</span> <span class="p">);</span></code></pre></figure>

<p>I also documented the python code, it’s available <a href="https://rawgit.com/qati/GSOC16/master/doc/html/index.html">here</a>.</p>

<p>Also made tutorial notebooks (<a href="http://mybinder.org/repo/qati/GSOC16"> on binder</a>).</p>
    
  </article>

  
    <div class="related-posts">
      <h4>Related Posts</h4>
      <ul>
        
          <li>
            <h5>
              <a href="/gsoc16/week/14-15/">
                Weeks 14-15: Deep neural network builder
                <small>15 Aug 2016</small>
              </a>
            </h5>
          </li>
        
          <li>
            <h5>
              <a href="/gsoc16/documentation/">
                Documentation
                <small>15 Aug 2016</small>
              </a>
            </h5>
          </li>
        
          <li>
            <h5>
              <a href="/gsoc16/week/8/">
                Week 8: Interactive training
                <small>24 Jun 2016</small>
              </a>
            </h5>
          </li>
        
      </ul>
    </div>
  

  <div class="author-info">
    
      <div class="author">   <a href="/about">    <img       src="/assets/images/avatar.jpg"      alt="Google Summer of Code Blog" width="60" height="60" />  </a>    <h5>Author</h4>  <h6>    <a href="/about">      Attila Bagoly    </a>  </h5>  <p>    Find me on            <a title="q_atti on Twitter"             href="https://twitter.com/q_atti"             class="twitter" target="_blank">Twitter</a>                /        <a title="battila93 on Facebook"             href="https://facebook.com/battila93"             class="facebook" target="_blank">Facebook</a>           </p></div>
    
  
    
      <div class="share-buttons">  <h5>Share this post on</h5>  <ul class="social-media">    <li>        <a title="Gmail"          href="mailto:?subject=Attila Bagoly's blog post: Weeks 9-13: Interactive training, new user interface, tutorial notebooks, documentation&amp;body=/gsoc16/week/9-13/" class="gmail">          Gmail        </a>    </li>    <li>        <a title="q_atti on Twitter"          href="https://twitter.com/intent/tweet?original_referer=/gsoc16/week/9-13/&amp;text=Weeks 9-13: Interactive training, new user interface, tutorial notebooks, documentation&amp;url=/gsoc16/week/9-13/" class="twitter wc-img-replace" target="_blank">          Twitter        </a>    </li>    <li>        <a title=" on Google Plus"            href="https://plus.google.com/share?url=/gsoc16/week/9-13/"            class="google wc-img-replace" target="_blank">Google</a>    </li>    <li>        <a title="battila93 on Facebook"            href="https://www.facebook.com/sharer/sharer.php?u=/gsoc16/week/9-13/&amp;t=Weeks 9-13: Interactive training, new user interface, tutorial notebooks, documentation"            class="facebook wc-img-replace" target="_blank">Facebook</a>    </li>  </ul></div>

      
  </div>
  
  
</div>

      </div>
      <a href="#0" class="wc-top">Top</a>

    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle">
      <span></span>
    </label>

    <script type="text/javascript">
      var config = {
        "browser_warning_page": "/browser-warning/",
        "disqus_shortname": ""
      };
      /* Browser support detection */
      var browserSupport = (function(){
        var htmlElemClasses = document.querySelector('html').className.split(' ');
        for ( var i = 0; i < htmlElemClasses.length; i += 1 ){
          var className = htmlElemClasses[i];
          if ( className === 'lt-ie9' ){
            return true;
          }
        }
      }());

      if (browserSupport){
        window.location="/browser-warning/";
      }

      /* To avoid render blocking css */
      var cb = function() {
        var l = document.createElement('link'); l.rel = 'stylesheet';
        l.href = 'http://fonts.googleapis.com/css?family=PT+Sans';
        var h = document.getElementsByTagName('head')[0]; h.parentNode.insertBefore(l, h);
      };
      var raf = requestAnimationFrame || mozRequestAnimationFrame ||
          webkitRequestAnimationFrame || msRequestAnimationFrame;
      if (raf) raf(cb);
      else window.addEventListener('load', cb);


    </script>
    <script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
    <script async type="text/javascript" src="/assets/js/gaya.min.js"></script>

    
    
<script>  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');  ga('create', 'UA-78841281-1' , 'auto');  ga('send', 'pageview');</script>


  </body>
</html>
